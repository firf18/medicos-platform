# ğŸ©º Flujo de Registro de MÃ©dico - Red-Salud

## ğŸ“‹ Resumen del Flujo

El registro de mÃ©dico en Red-Salud es un proceso de **6 pasos** diseÃ±ado para cumplir con estÃ¡ndares mÃ©dicos de compliance, seguridad y verificaciÃ³n de identidad. Cada paso estÃ¡ optimizado para recopilar informaciÃ³n especÃ­fica y validar datos crÃ­ticos para la prÃ¡ctica mÃ©dica.

## ğŸ”„ Diagrama del Flujo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    REGISTRO DE MÃ‰DICO                          â”‚
â”‚                        Red-Salud                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 1: INFORMACIÃ“N PERSONAL                                   â”‚
â”‚  â€¢ Datos bÃ¡sicos (nombre, email, telÃ©fono)                     â”‚
â”‚  â€¢ CreaciÃ³n de contraseÃ±a segura                                â”‚
â”‚  â€¢ ValidaciÃ³n de email Ãºnico                                    â”‚
â”‚  â€¢ VerificaciÃ³n de formato de datos                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 2: INFORMACIÃ“N PROFESIONAL                               â”‚
â”‚  â€¢ NÃºmero de licencia mÃ©dica                                    â”‚
â”‚  â€¢ Estado/paÃ­s de emisiÃ³n                                       â”‚
â”‚  â€¢ Fecha de vencimiento                                         â”‚
â”‚  â€¢ AÃ±os de experiencia                                          â”‚
â”‚  â€¢ Hospital/clÃ­nica actual                                      â”‚
â”‚  â€¢ Afiliaciones clÃ­nicas                                        â”‚
â”‚  â€¢ BiografÃ­a profesional                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 3: SELECCIÃ“N DE ESPECIALIDAD                              â”‚
â”‚  â€¢ SelecciÃ³n de especialidad principal                         â”‚
â”‚  â€¢ Sub-especialidades                                           â”‚
â”‚  â€¢ Servicios ofrecidos                                          â”‚
â”‚  â€¢ Tarifas por consulta                                        â”‚
â”‚  â€¢ Disponibilidad geogrÃ¡fica                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 4: VERIFICACIÃ“N DE IDENTIDAD                              â”‚
â”‚  â€¢ IntegraciÃ³n con Didit.me                                    â”‚
â”‚  â€¢ VerificaciÃ³n biomÃ©trica                                      â”‚
â”‚  â€¢ ValidaciÃ³n de documentos                                     â”‚
â”‚  â€¢ VerificaciÃ³n de licencia mÃ©dica                             â”‚
â”‚  â€¢ Screening AML                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 5: CONFIGURACIÃ“N DEL DASHBOARD                            â”‚
â”‚  â€¢ SelecciÃ³n de caracterÃ­sticas del dashboard                  â”‚
â”‚  â€¢ ConfiguraciÃ³n de horarios de trabajo                        â”‚
â”‚  â€¢ Preferencias de notificaciones                               â”‚
â”‚  â€¢ ConfiguraciÃ³n de privacidad                                 â”‚
â”‚  â€¢ ConfiguraciÃ³n de retenciÃ³n de datos                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 6: REVISIÃ“N FINAL                                         â”‚
â”‚  â€¢ RevisiÃ³n completa de datos                                  â”‚
â”‚  â€¢ AceptaciÃ³n de tÃ©rminos y condiciones                         â”‚
â”‚  â€¢ AceptaciÃ³n de polÃ­tica de privacidad                       â”‚
â”‚  â€¢ AceptaciÃ³n de compliance mÃ©dico                             â”‚
â”‚  â€¢ EnvÃ­o final del registro                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  COMPLETADO                                                     â”‚
â”‚  â€¢ Registro exitoso                                            â”‚
â”‚  â€¢ RedirecciÃ³n a verificaciÃ³n de email                        â”‚
â”‚  â€¢ ActivaciÃ³n de cuenta                                        â”‚
â”‚  â€¢ Acceso al dashboard mÃ©dico                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ Detalles de Cada Paso

### ğŸ”¹ Paso 1: InformaciÃ³n Personal
**Objetivo**: Recopilar datos bÃ¡sicos de identificaciÃ³n y contacto

**Campos requeridos**:
- Nombre completo (firstName, lastName)
- Email profesional Ãºnico
- NÃºmero de telÃ©fono
- ContraseÃ±a segura (mÃ­nimo 8 caracteres, con mayÃºsculas, minÃºsculas, nÃºmeros y sÃ­mbolos)
- ConfirmaciÃ³n de contraseÃ±a

**Validaciones**:
- Email Ãºnico en la base de datos
- Formato de email vÃ¡lido
- TelÃ©fono con formato internacional
- ContraseÃ±a cumple criterios de seguridad
- ConfirmaciÃ³n de contraseÃ±a coincide

**Seguridad**:
- Hash de contraseÃ±a con bcrypt
- ValidaciÃ³n en tiempo real
- PrevenciÃ³n de inyecciÃ³n SQL

### ğŸ”¹ Paso 2: InformaciÃ³n Profesional
**Objetivo**: Verificar credenciales mÃ©dicas y experiencia profesional

**Campos requeridos**:
- NÃºmero de licencia mÃ©dica
- Estado/paÃ­s de emisiÃ³n de la licencia
- Fecha de vencimiento de la licencia
- AÃ±os de experiencia clÃ­nica
- Hospital o clÃ­nica actual
- Afiliaciones clÃ­nicas adicionales
- BiografÃ­a profesional (mÃ­nimo 100 caracteres)

**Validaciones**:
- Formato de nÃºmero de licencia vÃ¡lido
- Fecha de vencimiento futura
- AÃ±os de experiencia coherentes
- BiografÃ­a profesional apropiada

**Compliance**:
- VerificaciÃ³n de licencia mÃ©dica activa
- ValidaciÃ³n de credenciales profesionales
- Audit trail de informaciÃ³n profesional

### ğŸ”¹ Paso 3: SelecciÃ³n de Especialidad
**Objetivo**: Definir el Ã¡rea de especializaciÃ³n mÃ©dica

**Campos requeridos**:
- Especialidad mÃ©dica principal
- Sub-especialidades (opcional)
- Servicios mÃ©dicos ofrecidos
- Tarifas por consulta
- Disponibilidad geogrÃ¡fica

**Validaciones**:
- Especialidad vÃ¡lida en el sistema
- Servicios coherentes con la especialidad
- Tarifas dentro de rangos razonables

**Funcionalidades**:
- BÃºsqueda inteligente de especialidades
- Sugerencias basadas en experiencia
- ValidaciÃ³n de compatibilidad de servicios

### ğŸ”¹ Paso 4: VerificaciÃ³n de Identidad
**Objetivo**: Verificar identidad mediante tecnologÃ­a biomÃ©trica

**Proceso**:
1. **IniciaciÃ³n**: Solicitud de verificaciÃ³n a Didit.me
2. **Documento**: Captura de documento de identidad
3. **BiometrÃ­a**: VerificaciÃ³n facial y liveness check
4. **ValidaciÃ³n**: VerificaciÃ³n de licencia mÃ©dica
5. **Screening**: VerificaciÃ³n AML y listas de vigilancia

**TecnologÃ­as**:
- VerificaciÃ³n facial con IA
- DetecciÃ³n de vida (liveness)
- OCR para extracciÃ³n de datos
- VerificaciÃ³n de autenticidad de documentos
- Screening AML automatizado

**Compliance**:
- Cumplimiento con regulaciones de identidad
- Audit trail completo de verificaciÃ³n
- Almacenamiento seguro de datos biomÃ©tricos

### ğŸ”¹ Paso 5: ConfiguraciÃ³n del Dashboard
**Objetivo**: Personalizar la experiencia del mÃ©dico en la plataforma

**Configuraciones**:
- **CaracterÃ­sticas del dashboard**:
  - GestiÃ³n de pacientes
  - Historiales mÃ©dicos
  - Agenda de citas
  - ComunicaciÃ³n con pacientes
  - Reportes y estadÃ­sticas
  - IntegraciÃ³n con laboratorios

- **Horarios de trabajo**:
  - DÃ­as de la semana disponibles
  - Horarios de inicio y fin
  - Tiempos de descanso
  - Zona horaria

- **Preferencias de notificaciones**:
  - Email para recordatorios
  - SMS para emergencias
  - Notificaciones push
  - Recordatorios de citas
  - Resultados de laboratorio
  - Mensajes de pacientes

- **ConfiguraciÃ³n de privacidad**:
  - RetenciÃ³n de datos de pacientes
  - Historial de citas
  - Logs de comunicaciÃ³n
  - Datos analÃ­ticos

### ğŸ”¹ Paso 6: RevisiÃ³n Final
**Objetivo**: Confirmar todos los datos antes del envÃ­o final

**Elementos de revisiÃ³n**:
- Resumen completo de informaciÃ³n personal
- Resumen de informaciÃ³n profesional
- Especialidad y servicios seleccionados
- Estado de verificaciÃ³n de identidad
- ConfiguraciÃ³n del dashboard
- TÃ©rminos y condiciones mÃ©dicos

**Aceptaciones requeridas**:
- âœ… TÃ©rminos y condiciones de uso
- âœ… PolÃ­tica de privacidad
- âœ… Acuerdo de compliance mÃ©dico
- âœ… Consentimiento para procesamiento de datos

**Proceso de envÃ­o**:
1. ValidaciÃ³n final de todos los datos
2. CreaciÃ³n de cuenta en Supabase Auth
3. InserciÃ³n de datos mÃ©dicos en base de datos
4. ConfiguraciÃ³n de permisos RLS
5. EnvÃ­o de email de verificaciÃ³n
6. RedirecciÃ³n a pÃ¡gina de verificaciÃ³n

## ğŸ”’ Medidas de Seguridad y Compliance

### Seguridad de Datos
- **EncriptaciÃ³n**: Todos los datos mÃ©dicos encriptados en trÃ¡nsito y reposo
- **RLS**: Row Level Security en todas las tablas mÃ©dicas
- **Audit Trail**: Registro completo de todas las operaciones
- **ValidaciÃ³n**: ValidaciÃ³n estricta de todos los inputs
- **SanitizaciÃ³n**: SanitizaciÃ³n de datos para prevenir inyecciones

### Compliance MÃ©dico
- **HIPAA-Style**: Cumplimiento con estÃ¡ndares de privacidad mÃ©dica
- **VerificaciÃ³n**: VerificaciÃ³n obligatoria de credenciales mÃ©dicas
- **Consentimiento**: Consentimiento explÃ­cito para procesamiento de datos
- **RetenciÃ³n**: PolÃ­ticas claras de retenciÃ³n de datos mÃ©dicos
- **Acceso**: Control granular de acceso a datos sensibles

### Validaciones EspecÃ­ficas
- **Licencia MÃ©dica**: VerificaciÃ³n de validez y vigencia
- **Identidad**: VerificaciÃ³n biomÃ©trica obligatoria
- **Especialidad**: ValidaciÃ³n de especialidades reconocidas
- **Experiencia**: VerificaciÃ³n de aÃ±os de experiencia
- **Contacto**: ValidaciÃ³n de informaciÃ³n de contacto

## ğŸš€ Flujo de Post-Registro

### Inmediatamente despuÃ©s del registro:
1. **Email de verificaciÃ³n** enviado automÃ¡ticamente
2. **Cuenta creada** pero inactiva hasta verificaciÃ³n
3. **Datos almacenados** en base de datos con RLS
4. **Permisos configurados** segÃºn rol mÃ©dico

### DespuÃ©s de verificaciÃ³n de email:
1. **ActivaciÃ³n de cuenta** automÃ¡tica
2. **RedirecciÃ³n al dashboard** mÃ©dico
3. **ConfiguraciÃ³n inicial** aplicada
4. **Notificaciones** configuradas segÃºn preferencias

### Primer acceso al dashboard:
1. **Tour guiado** de la plataforma
2. **ConfiguraciÃ³n adicional** de perfil
3. **ImportaciÃ³n de datos** existentes (opcional)
4. **ConfiguraciÃ³n de integraciones** (laboratorios, etc.)

## ğŸ“Š MÃ©tricas y Monitoreo

### MÃ©tricas de Registro
- **Tasa de completaciÃ³n**: % de usuarios que completan el registro
- **Tiempo promedio**: Tiempo promedio para completar cada paso
- **Abandono por paso**: Identificar pasos con mayor abandono
- **Errores comunes**: Errores mÃ¡s frecuentes en cada paso

### Monitoreo de Seguridad
- **Intentos de registro**: Monitoreo de intentos sospechosos
- **Verificaciones fallidas**: Tracking de verificaciones de identidad fallidas
- **Accesos no autorizados**: DetecciÃ³n de intentos de acceso no autorizado
- **Audit logs**: Registro completo de actividades de seguridad

## ğŸ”§ ConfiguraciÃ³n TÃ©cnica

### Variables de Entorno Requeridas
```bash
# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# Didit.me Integration
DIDIT_API_KEY=your_didit_api_key
DIDIT_WEBHOOK_SECRET=your_webhook_secret

# Medical Compliance
MEDICAL_AUDIT_ENDPOINT=https://audit.yourcompany.com
HIPAA_COMPLIANCE_MODE=true
ENCRYPTION_KEY=your_encryption_key

# Security
RATE_LIMIT_ENABLED=true
SESSION_TIMEOUT_MINUTES=30
MAX_LOGIN_ATTEMPTS=3
```

### Dependencias Requeridas
```json
{
  "dependencies": {
    "@supabase/supabase-js": "^2.39.0",
    "zod": "^3.22.4",
    "bcryptjs": "^2.4.3",
    "react-hook-form": "^7.48.2",
    "@hookform/resolvers": "^3.3.2"
  }
}
```

## ğŸ¯ PrÃ³ximos Pasos

1. **Implementar validaciones mÃ©dicas** especÃ­ficas
2. **Integrar con Didit.me** para verificaciÃ³n de identidad
3. **Configurar RLS policies** en Supabase
4. **Implementar audit logging** completo
5. **Crear tests automatizados** para flujo de registro
6. **Configurar monitoreo** de seguridad y compliance

---

**Este flujo estÃ¡ diseÃ±ado para cumplir con los mÃ¡s altos estÃ¡ndares de seguridad mÃ©dica y compliance, garantizando la protecciÃ³n de datos sensibles y la verificaciÃ³n adecuada de credenciales profesionales.**
